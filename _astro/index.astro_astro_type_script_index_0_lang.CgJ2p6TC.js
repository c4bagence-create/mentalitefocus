document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("price-tag");c&&setTimeout(()=>{c.classList.add("landed")},1200);const p={threshold:.5},a=new IntersectionObserver(t=>{t.forEach(e=>{e.isIntersecting&&(e.target.querySelectorAll("[data-count]").forEach(o=>{const r=parseInt(o.dataset.count);let i=0;const h=r/50,k=setInterval(()=>{i+=h,i>=r&&(i=r,clearInterval(k)),o.textContent=Math.floor(i)+(r>100?"+":"")},30)}),a.unobserve(e.target))})},p),l=document.querySelector(".footer-stats");l&&a.observe(l),document.getElementById("scroll-top")?.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const d=document.getElementById("klaviyo-form"),w=document.getElementById("klaviyo-email"),u=document.getElementById("klaviyo-submit"),m=document.getElementById("newsletter-success"),g=document.querySelector(".newsletter-container");d&&d.addEventListener("submit",async t=>{t.preventDefault();const e=w?.value?.trim();if(e){u?.classList.add("loading");try{console.log("üîç Checking Klaviyo...",typeof window.klaviyo);const n=()=>new Promise(o=>{window._learnq||window.klaviyo?o(!0):setTimeout(()=>n().then(o),100)});await n(),window._learnq?(window._learnq.push(["identify",{$email:e,$source:"Website Footer",Newsletter:!0}]),window._learnq.push(["track","Newsletter Signup",{$email:e,Source:"Footer Form",Page:window.location.href,Timestamp:new Date().toISOString()}]),console.log("‚úÖ Klaviyo (_learnq) - Profile created and Newsletter Signup tracked")):window.klaviyo?(window.klaviyo.push(["identify",{$email:e,$source:"Website Footer",Newsletter:!0}]),window.klaviyo.push(["track","Newsletter Signup",{$email:e,Source:"Footer Form",Page:window.location.href,Timestamp:new Date().toISOString()}]),console.log("‚úÖ Klaviyo (new API) - Profile created and Newsletter Signup tracked")):console.error("‚ùå Klaviyo not loaded!"),g?.classList.add("submitted"),m?.classList.add("show"),typeof fbq<"u"&&(fbq("track","Lead",{content_name:"Newsletter Footer"}),console.log("‚úÖ Meta - Lead tracked")),typeof snaptr<"u"&&(snaptr("track","SIGN_UP",{sign_up_method:"newsletter"}),console.log("‚úÖ Snapchat - SIGN_UP tracked")),typeof ttq<"u"&&(ttq.track("Subscribe",{content_type:"newsletter",description:"Newsletter Footer Signup"}),console.log("‚úÖ TikTok - Subscribe tracked"))}catch(n){console.error("Newsletter signup error:",n)}u?.classList.remove("loading")}});const y=[".premium-cta",".card-btn",".price-tag",'[href*="stripe"]','[href*="discord"]','a[href="#pricing"]','a[href="#premium-card"]'];document.querySelectorAll(y.join(", ")).forEach(t=>{t.addEventListener("click",()=>{const e=t.textContent?.trim()||"Unknown CTA",n=t.getAttribute("href")||"",o=t.closest("section")?.id||"unknown";typeof _learnq<"u"&&_learnq.push(["track","CTA Clicked",{cta_text:e.substring(0,50),cta_href:n,section:o,page:window.location.href,timestamp:new Date().toISOString()}]),typeof fbq<"u"&&fbq("trackCustom","CTAClick",{cta_text:e.substring(0,50),section:o}),typeof snaptr<"u"&&(n.includes("stripe")?snaptr("track","START_CHECKOUT",{currency:"EUR",price:9.9,item_category:"Focus Business Membership"}):snaptr("track","VIEW_CONTENT",{content_type:"cta_click",item_category:o})),typeof ttq<"u"&&(n.includes("stripe")?ttq.track("InitiateCheckout",{value:9.9,currency:"EUR",content_type:"product",content_name:"Focus Business Membership"}):ttq.track("ClickButton",{content_type:"cta",content_name:e.substring(0,50)})),console.log("üìä CTA Tracked:",e.substring(0,30),"| Section:",o)})});const f=document.getElementById("pricing");if(f){const t=new IntersectionObserver(e=>{e.forEach(n=>{n.isIntersecting&&(typeof _learnq<"u"&&_learnq.push(["track","Viewed Pricing",{page:window.location.href}]),typeof fbq<"u"&&fbq("track","ViewContent",{content_name:"Pricing Section"}),typeof snaptr<"u"&&snaptr("track","VIEW_CONTENT",{content_type:"pricing",item_category:"Focus Business Membership"}),t.unobserve(n.target))})},{threshold:.5});t.observe(f)}let s={25:!1,50:!1,75:!1,100:!1};window.addEventListener("scroll",()=>{const t=Math.round(window.scrollY/(document.body.scrollHeight-window.innerHeight)*100);Object.keys(s).forEach(e=>{t>=parseInt(e)&&!s[e]&&(s[e]=!0,typeof _learnq<"u"&&_learnq.push(["track","Scroll Depth",{depth:e+"%",page:window.location.href}]))})},{passive:!0})});
