document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("price-tag");l&&setTimeout(()=>{l.classList.add("landed")},1200);const p={threshold:.5},d=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(t.target.querySelectorAll("[data-count]").forEach(r=>{const o=parseInt(r.dataset.count);let i=0;const k=o/50,v=setInterval(()=>{i+=k,i>=o&&(i=o,clearInterval(v)),r.textContent=Math.floor(i)+(o>100?"+":"")},30)}),d.unobserve(t.target))})},p),u=document.querySelector(".footer-stats");u&&d.observe(u),document.getElementById("scroll-top")?.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const f=document.getElementById("klaviyo-form"),y=document.getElementById("klaviyo-email"),g=document.getElementById("klaviyo-submit"),w=document.getElementById("newsletter-success"),h=document.querySelector(".newsletter-container");f&&f.addEventListener("submit",async e=>{e.preventDefault();const t=y?.value?.trim();if(t){g?.classList.add("loading");try{try{localStorage.setItem("focus_user_email",t)}catch(n){console.warn("LocalStorage not available for email capture:",n)}typeof window.klaviyo<"u"&&(window.klaviyo.push(["identify",{$email:t,$source:"Focus Website Footer"}]),window.klaviyo.push(["subscribe",{email:t,list:"UxpEGn"}]),window.klaviyo.push(["track","Newsletter Signup",{source:"Footer Form",page:window.location.href,timestamp:new Date().toISOString()}]),console.log("âœ… Klaviyo - Newsletter Signup + List Subscribe tracked")),h?.classList.add("submitted"),w?.classList.add("show"),typeof gtag<"u"&&(gtag("event","generate_lead",{currency:"EUR",value:0,lead_source:"newsletter_footer"}),console.log("âœ… Google Analytics - Lead tracked")),typeof fbq<"u"&&(fbq("track","Contact",{content_name:"Newsletter Subscription"}),console.log("âœ… Meta - Contact tracked")),typeof snaptr<"u"&&(snaptr("track","SIGN_UP",{sign_up_method:"newsletter"}),console.log("âœ… Snapchat - SIGN_UP tracked"))}catch(n){console.error("Newsletter signup error:",n)}g?.classList.remove("loading")}});const _=[".premium-cta",".card-btn",".price-tag",'[href*="checkout"]','[href*="espace.mentalitefocus"]','[href*="stripe"]','[href*="discord"]','a[href="#offre-unique"]','a[href="#premium-card"]'];document.querySelectorAll(_.join(", ")).forEach(e=>{e.addEventListener("click",()=>{const t=e.textContent?.trim()||"Unknown CTA",n=e.getAttribute("href")||"",r=e.closest("section")?.id||"unknown",o=n.includes("/checkout")||n.includes("espace.mentalitefocus")||n.includes("stripe");typeof _learnq<"u"&&_learnq.push(["track","CTA Clicked",{cta_text:t.substring(0,50),cta_href:n,section:r,page:window.location.href,timestamp:new Date().toISOString()}]),typeof gtag<"u"&&(o?gtag("event","begin_checkout",{currency:"EUR",value:9.9,items:[{item_name:"Focus Business Membership",item_category:"Subscription",price:9.9,quantity:1}]}):gtag("event","cta_click",{cta_name:t.substring(0,50),cta_location:r,cta_url:n})),typeof fbq<"u"&&(fbq("trackCustom","CTAClick",{cta_text:t.substring(0,50),section:r}),o&&fbq("track","InitiateCheckout",{value:9.9,currency:"EUR",content_name:"Focus Business Subscription",content_type:"product",content_ids:["focus-premium"],num_items:1})),typeof snaptr<"u"&&(o?snaptr("track","START_CHECKOUT",{currency:"EUR",price:9.9,item_category:"Focus Business Membership"}):snaptr("track","VIEW_CONTENT",{content_type:"cta_click",item_category:r})),console.log("ðŸ“Š CTA Tracked:",t.substring(0,30),"| Section:",r)})}),["hero","discord","arsenal","experts","networking","pricing","faq"].forEach(e=>{const t=document.getElementById(e);if(t){const n=new IntersectionObserver(r=>{r.forEach(o=>{o.isIntersecting&&(typeof gtag<"u"&&gtag("event","section_view",{section_name:e,engagement_type:"scroll"}),e==="pricing"&&typeof _learnq<"u"&&_learnq.push(["track","Viewed Pricing",{page:window.location.href}]),e==="pricing"&&typeof fbq<"u"&&fbq("track","ViewContent",{content_name:"Pricing Section"}),e==="pricing"&&typeof snaptr<"u"&&snaptr("track","VIEW_CONTENT",{content_type:"pricing",item_category:"Focus Business Membership"}),console.log("ðŸ“Š Section Viewed:",e),n.unobserve(o.target))})},{threshold:.3});n.observe(t)}});let s={25:!1,50:!1,75:!1,100:!1};window.addEventListener("scroll",()=>{const e=Math.round(window.scrollY/(document.body.scrollHeight-window.innerHeight)*100);Object.keys(s).forEach(t=>{e>=parseInt(t)&&!s[t]&&(s[t]=!0,typeof gtag<"u"&&gtag("event","scroll",{percent_scrolled:parseInt(t)}),typeof _learnq<"u"&&_learnq.push(["track","Scroll Depth",{depth:t+"%",page:window.location.href}]),console.log("ðŸ“Š Scroll Depth:",t+"%"))})},{passive:!0}),document.querySelectorAll(".social-link").forEach(e=>{e.addEventListener("click",t=>{const n=e.getAttribute("aria-label")||"Unknown";typeof gtag<"u"&&gtag("event","social_click",{social_network:n.toLowerCase(),link_location:"footer"}),console.log("ðŸ“Š Social Click:",n)})});let c=Date.now(),a=!0;document.addEventListener("visibilitychange",()=>{if(document.hidden){a=!1;const e=Math.floor((Date.now()-c)/1e3);typeof gtag<"u"&&e>10&&gtag("event","user_engagement",{engagement_time_msec:e*1e3})}else c=Date.now(),a=!0}),setInterval(()=>{if(a&&!document.hidden){const e=Math.floor((Date.now()-c)/1e3);e>=30&&typeof gtag<"u"&&(gtag("event","user_engagement",{engagement_time_msec:e*1e3}),c=Date.now())}},3e4);const m=document.getElementById("klaviyo-email");m&&m.addEventListener("focus",()=>{typeof gtag<"u"&&gtag("event","form_start",{form_name:"newsletter",form_location:"footer"}),console.log("ðŸ“Š Newsletter Form Started")})});
